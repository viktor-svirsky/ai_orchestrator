=============================================================================
QUOTA LIMIT HANDLING & AUTOMATIC FALLBACK - QUICK GUIDE
=============================================================================

WHAT IS THIS?
-------------
The AI Orchestrator now automatically handles API quota limits and provider
failures by seamlessly falling back to alternative AI providers.

HOW IT WORKS:
------------
When a provider (like Gemini) hits its quota limit:

1. ‚ùå Error detected: "You have exhausted your capacity on this model"
2. üîç System recognizes it as a quota error (not retryable)
3. ‚ö†Ô∏è  User notification: "‚ö† gemini quota exhausted. Trying next provider..."
4. ‚è≠Ô∏è  Automatic fallback to next provider in priority list
5. ‚úÖ Workflow continues without interruption

PROVIDER PRIORITY CHAINS:
-------------------------
Each role has a fallback chain (from config.yaml):

üìã Planner:    claude ‚Üí gemini ‚Üí ollama
üíª Coder:      gemini ‚Üí claude ‚Üí ollama
üß™ Tester:     gemini ‚Üí claude ‚Üí ollama
üîç Reviewer:   claude ‚Üí ollama ‚Üí gemini
üìù Documenter: ollama ‚Üí gemini ‚Üí claude

Example: If coding step tries gemini and hits quota, it automatically tries
claude, then ollama if claude also fails.

ERROR TYPES HANDLED:
-------------------
‚úì Quota exhausted (429 errors)
‚úì Rate limits
‚úì Network timeouts
‚úì Connection errors
‚úì Provider unavailable

RETRY STRATEGY:
--------------
- Quota errors: NO retry (immediate fallback)
  Reason: Quota needs time to reset (often 24 hours)

- Transient errors: YES retry with exponential backoff
  Attempt 1: Immediate
  Attempt 2: After 2 seconds
  Attempt 3: After 4 seconds
  Attempt 4: After 8 seconds
  Then: Fallback to next provider

USAGE:
------
No changes needed! Just run the script as usual:

  python3 ai_orchestrator.py "Your prompt here"

Or interactively:

  python3 ai_orchestrator.py

The system handles everything automatically.

WHAT YOU'LL SEE:
---------------
Normal operation:
  [2/6] Writing Initial Code...
  14:46:31 [INFO] [Coder] Trying gemini...
  ‚úì Initial code generated by gemini.

With quota limit:
  [2/6] Writing Initial Code...
  14:46:31 [INFO] [Coder] Trying gemini...
  ‚ö† gemini quota exhausted. Trying next provider...
  14:46:31 [INFO] [Coder] Trying claude...
  14:46:45 [INFO] [Coder] ‚úì Successfully fell back to claude
  ‚úì Initial code generated by claude.

CONFIGURATION:
-------------
All settings in config.yaml under:
- providers: retry_attempts, retry_delay
- workflow.role_priorities: fallback chains

BENEFITS:
---------
‚úÖ Zero downtime due to quota limits
‚úÖ Automatic failover
‚úÖ Clear logging
‚úÖ No manual intervention needed
‚úÖ Optimal provider selection per role
‚úÖ Graceful degradation

TROUBLESHOOTING:
---------------
Q: What if all providers fail?
A: You'll see "All providers failed for [role]. Attempted: gemini, claude, ollama"

Q: Can I change the priority order?
A: Yes! Edit config.yaml ‚Üí workflow ‚Üí role_priorities

Q: How do I check which providers are available?
A: The script shows a warning at startup listing unavailable providers

Q: Does this work for all modes?
A: The script now ONLY runs in workflow mode (simplified)

MONITORING:
----------
Check logs for fallback events:
  grep "falling back" logs/*.log
  grep "quota exhausted" logs/*.log

